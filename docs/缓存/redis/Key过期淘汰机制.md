### 设置过期时间
设置了过期时间的key，redis有2中策略去删除。
1. 定期删除
redis每隔100ms随机抽取一些设置了过期时间的key，检测这些key是否过期了，过期的key将会被删除。
2. 惰性删除
在定期删除策略中存活下来的过期key，在用户访问这个key的时候，会被删除

### 内存淘汰机制
redis可以配置maxmemory来开启内存淘汰机制，一旦开启内存淘汰机制，当内存达到maxmemory阀值时，即使key没有过期，也会根据一定的策略对数据进行淘汰。maxmemory为0的时候表示对内存的使用没有限制。
Redis内存淘汰策略有以下几种：

`volatile-lru`，从已设置过期时间的数据集中挑选最近最少使用的数据淘汰，设置过期时间的数据在server.db[i].expires字典中，Redis并不是将所有的最近最少使用的数据全部淘汰，而是随机挑选几个进行淘汰。

`volatile-ttl`，从已设置过期时间的数据集中挑选将要过期的数据进行淘汰，设置过期时间的数据在server.db[i].expires字典中，Redis并不是将所有的将要过期的数据全部淘汰，而是随机挑选几个进行淘汰。

`volatile-random`，从已设置过期时间的数据集中随机选择数据进行淘汰。

`allkeys-lru`，从所有数据集中挑选最近最少使用的数据淘汰，数据集在服务器的server.db[i].dict字典中。

`allkeys-random`，从所有数据集中随机选择数据进行淘汰，数据集在服务器的server.db[i].dict字典中。

`no-enviction`，禁止淘汰数据，新写入会报错。

Redis4.0之后增加了两个LFU（Least Frequently Used）使用频率最少的：

`volatile-lfu`，从已设置过期时间的数据集中选择使用频率最少的数据进行淘汰。

`allkeys-lfu`，从所有数据集中选择使用频率最少的数据进行淘汰。
一般会选择allkeys-lru淘汰策略，原因是如果我们的应用对缓存的访问符合幂律分布，存在相对热点数据，或者不太清楚应用的缓存访问分布状况，则可以选allkeys-lru策略。
